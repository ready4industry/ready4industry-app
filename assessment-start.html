<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Skills Challenge Dashboard</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: "Inter", sans-serif;
      background-color: #f9fafb;
    }
    #app-root {
      min-height: 100vh;
    }
  </style>
</head>

<body class="p-4 md:p-8">
  <div id="app-root">
    <div id="content-container"></div>
  </div>

  <div
    id="user-message-box"
    class="fixed top-4 right-4 z-50 p-4 rounded-lg shadow-xl text-white font-semibold transition-opacity duration-300 opacity-0 pointer-events-none"
  ></div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    // --- CONFIGURATION ---
    const MOCK_USERS = {
      user_keshav: { id: "user_keshav", name: "Keshav Karn", email: "keshav.karn@example.com" },
      user_admin: { id: "user_admin", name: "Mentor Admin", email: "ready4industry@gmail.com" },
    };

    const MODULES = [
      { id: "technical", name: "Technical Fundamentals", topic: "BTech Graduate Syllabus Fundamentals" },
      { id: "aptitude", name: "Aptitude & Reasoning", topic: "Aptitude and Reasoning Fundamentals" },
      { id: "behavioural", name: "Behavioural Skills", topic: "Behavioural Fundamentals" },
    ];

    // --- SUPABASE SETUP ---
    const SUPABASE_URL = "https://glskwkzzkhhwftzddqmo.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdsc2t3a3p6a2hod2Z0emRkcW1vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk1MDg2OTEsImV4cCI6MjA3NTA4NDY5MX0.g3XQyV6T_xfBCSOb0X1idGNzD0zEBbMhX8RZ1PLH5R8";

    let supabase; // Declared here
    let currentUserId = "user_keshav";
    let appState = {}; 

    // --- UTILITIES ---
    const showUserMessage = (msg, type = "info") => {
      const box = document.getElementById("user-message-box");
      let color = "bg-blue-500";
      if (type === "error") color = "bg-red-500";
      if (type === "success") color = "bg-green-500";
      box.textContent = msg;
      box.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-xl text-white font-semibold ${color}`;
      box.style.opacity = "1";
      box.style.pointerEvents = "auto";
      setTimeout(() => {
        box.style.opacity = "0";
        box.style.pointerEvents = "none";
      }, 3000);
    };

    // --- RENDER FUNCTIONS (Stubbed) ---
    const renderDashboard = (c) => {
        c.innerHTML = `
          <div class="max-w-2xl mx-auto mt-20 p-10 bg-indigo-50 rounded-xl shadow-lg text-center">
              <h1 class="text-3xl font-bold text-indigo-700">Loading Configuration Complete.</h1>
              <p class="mt-2 text-gray-700">Check the console for successful Supabase client initialization.</p>
          </div>
        `;
    };

    const mainRender = () => {
      const c = document.getElementById("content-container");
      renderDashboard(c);
    };

    // --- INIT ---
    document.addEventListener("DOMContentLoaded", () => {
        try {
            // Step 1b: Initialize Supabase client
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            console.log("Supabase Client Initialized Successfully.");
            
            mainRender();

        } catch (e) {
            console.error("Critical Initialization Error:", e);
            document.getElementById("content-container").innerHTML = `
                <div class="max-w-xl mx-auto text-center p-8 bg-red-100 border border-red-400 text-red-700 rounded-xl shadow-lg mt-20">
                    <h2 class="text-2xl font-bold mb-4">Initial Script Failed ðŸ›‘</h2>
                    <p class="mt-4 font-mono text-sm break-all">Error: ${e.message || 'Check your browser console.'}</p>
                </div>
            `;
            showUserMessage(`Critical Init Error: ${e.message}`, 'error');
        }
    });
  </script>
</body>
</html>
